include ../parts/mixins

.mdl-grid
  - cardSettings = { phone: { s: 4 }, tablet: { s: 8, o: 0 }, desktop: { s: 8, o: 2 } }

- var weekdays = [{value: 'mon', text: 'понедельник'}, {value: 'tue', text: 'вторник'}, {value: 'wed', text: 'среда'}, {value: 'thu', text: 'четверг'}, {value: 'fri', text: 'пятница'}, {value: 'sat', text: 'суббота'}]

- var lessonData = [ {id: 3, teacherId: 3} ]

form(action='/t/timetable/', method='POST')
  +Card(cardSettings)
    .mdl-card__supporting-text(style='padding-bottom: 0px; margin-top: 5px;')
      +ComboBox('Группа', 'group', lists.groups, true, 'width: 45%; margin-right: 30px;')
      +ComboBox('День недели', 'day', weekdays, false, 'width: 45%;')
  
  +Text(cardSettings)
    h5(style='color: rgba(0,0,0,.3); text-align: center;') Занятия:

  each lesson in lists.timings
    - var lessonCode = 'lesson' + lesson.id;  
    - var hasLesson = !!lessonData.filter((item) => item.id == lesson.id).length;
    +Card(cardSettings, 'padding-bottom: 0px')
      .mdl-card__title(style='color: rgba(0,0,0,.55);')
        +Toggle(lessonCode + 'toggle', lesson.getDisplayName(), null, hasLesson)
      .mdl-card__supporting-text.lesson-editing-pane(id=(lessonCode+'wrapper'), class={'lesson-editing-pane-hidden': !hasLesson})
        +ComboBox('Предмет', lessonCode + 'subject', lists.subjects, false, 'width: 180px; margin-right: 30px;')
        +ComboBox('Преподаватель', lessonCode + 'teacher', lists.teachers, false, 'width: 180px; margin-right: 30px;')
        +ComboBox('Аудитория', lessonCode + 'auditory', lists.auditories, false, 'width: 100px; margin-right: 30px;')


script.
  $toggles = $('.mdl-switch__input');

  $toggles.on('click', function (ctx) {
    var lessonCode = ctx.target.id.split('togglefield')[0];
    $('#' + lessonCode + 'wrapper').toggleClass('lesson-editing-pane-hidden');    
  })